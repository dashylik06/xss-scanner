<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á–µ—Ç –æ–± –∞–Ω–∞–ª–∏–∑–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π - XSS Scanner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä –û—Ç—á–µ—Ç –æ–± –∞–Ω–∞–ª–∏–∑–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</h1>
            <p>–≠—Ç–æ—Ç –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ XSS (Cross-Site Scripting) —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.</p>
        </header>

        <nav>
            <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/scan" class="nav-link">–ù–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
            <a href="/history" class="nav-link">–ò—Å—Ç–æ—Ä–∏—è</a>
            <a href="/statistics" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
        </nav>

        <main>
            {% if error %}
            <div class="alert error">
                {{ error }}
            </div>
            {% elif results %}

            <div class="report-header">
                <div class="scan-info">
                    <p><strong>URL:</strong> {{ results.url }}</p>
                    <p><strong>–¢–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:</strong> {{ results.scan_type }}</p>
                    <p><strong>–í—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:</strong> {{ results.timestamp }}</p>
                </div>
            </div>

            {% set summary = results.scan_summary %}
            <div class="summary-section">
                <div class="security-level {{ summary.security_level|lower|replace(' ', '-') }}">
                    <h3>–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: {{ summary.security_level }}</h3>
                    <div class="stats">
                        <div class="stat">
                            <span class="stat-number {{ 'high-risk' if summary.high_risk > 0 else '' }}">{{ summary.high_risk }}</span>
                            <span class="stat-label">–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number {{ 'medium-risk' if summary.medium_risk > 0 else '' }}">{{ summary.medium_risk }}</span>
                            <span class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number {{ 'low-risk' if summary.low_risk > 0 else '' }}">{{ summary.low_risk }}</span>
                            <span class="stat-label">–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">{{ summary.total_vulnerabilities }}</span>
                            <span class="stat-label">–í—Å–µ–≥–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="vulnerability-section">
                <h2>Cross-Site Scripting (XSS) Vulnerabilities</h2>

                {% if results.vulnerabilities %}
                <p><strong>–ë—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ Cross-Site Scripting (XSS) —É—è–∑–≤–∏–º–æ—Å—Ç–∏:</strong></p>

                {% for vuln in results.vulnerabilities %}
                <div class="vulnerability-item {{ vuln.severity }}-severity">
                    <div class="vuln-details">
                        <p><strong>URL:</strong> {{ results.url }}</p>
                        <p><strong>Form Action:</strong> {{ results.url }}</p>
                        <p><strong>Parameter:</strong>
                            {% if vuln.location %}
                                {{ vuln.location.split(':')[-1].strip() if ':' in vuln.location else vuln.location }}
                            {% else %}
                                query
                            {% endif %}
                        </p>
                        <p><strong>Payload:</strong>
                            {% if vuln.evidence and vuln.evidence[0] %}
                                <code>{{ vuln.evidence[0] }}</code>
                            {% else %}
                                <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>
                            {% endif %}
                        </p>
                        <p><strong>Context:</strong> GET Parameter</p>
                    </div>
                    <div class="vuln-description">
                        <p>XSS –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º –≤–Ω–µ–¥—Ä—è—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã.</p>
                    </div>
                </div>
                {% endfor %}

                {% else %}
                <div class="no-vulnerabilities">
                    <p>Cross-Site Scripting (XSS) —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.</p>
                </div>
                {% endif %}
            </div>

            <div class="recommendations">
                <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                <div class="recommendation-list">
                    {% if recommendations %}
                        {% for rec in recommendations %}
                        <div class="recommendation-item">
                            <h4>{{ rec.title }}</h4>
                            <p>{{ rec.description }}</p>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="recommendation-item">
                            <h4>–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h4>
                            <p>–í—Å–µ–≥–¥–∞ —ç–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥.</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>Content Security Policy</h4>
                            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content Security Policy.</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h4>
                            <p>–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="actions">
                <a href="/scan" class="cta-button">–ù–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
                <button onclick="window.print()" class="secondary-button">–†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –æ—Ç—á–µ—Ç</button>
            </div>

            {% else %}
            <div class="alert info">
                <p>–î–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –í–æ–∑–º–æ–∂–Ω–æ, —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.</p>
                <a href="/scan" class="cta-button">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é</a>
            </div>
            {% endif %}
        </main>

        <footer>
            <p>&copy; XSS Scanner. –û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
        </footer>
    </div>
</body>
</html>
</html>